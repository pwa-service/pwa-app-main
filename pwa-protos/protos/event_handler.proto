syntax = "proto3";

package eventhandler.v1;

service EventHandlerService {
    rpc ViewContent          (ViewContentRequest)          returns (FirstOpenResponse);
    rpc PrepareInstallLink   (PrepareInstallLinkRequest)   returns (PrepareInstallLinkResponse);
    rpc PwaFirstOpen         (PwaFirstOpenRequest)         returns (GenericOk);
    rpc Event                (EventRequest)                returns (GenericOk);
}

message EventRequest {
    string pixel_id         = 1;
    string session_id       = 2;
    string pwa_domain       = 3;
    string landing_url      = 4;
    string query_string_raw = 5;
    double value            = 6;
    string currency         = 7;
    string event_type       = 8;
}

message ViewContentRequest {
    string pwa_domain       = 1;
    string landing_url      = 2;
    string query_string_raw = 3;
    string pixel_id         = 4;
}

message PrepareInstallLinkRequest {
    string pwa_domain = 1;
    string session_id = 2;
}

message PwaFirstOpenRequest {
    string pwa_domain = 1;
    string session_id = 2;
}

message LeadRequest {
    string pwa_domain = 1;
    string session_id = 2;
    string pixel_id   = 3;
}

message CompleteRegistrationRequest {
    string session_id = 1;
    string pixel_id   = 2;
    string pwa_domain = 3;
}

message PurchaseRequest {
    string pwa_domain = 2;
    string session_id = 3;
    string pixel_id   = 4;
    double value      = 5;
    string currency   = 6;
}

message SubscribeRequest {
    string pwa_domain = 2;
    string session_id = 3;
    string pixel_id   = 4;
    double value      = 5;
    string currency   = 6;
}

message FirstOpenResponse {
    bool   success    = 1;
    string fb         = 2;
    string session_id = 3;
}

message GenericOk {
    bool   success = 1;
    string fb      = 2;
}

message PrepareInstallLinkResponse {
    string final_url = 1;
}