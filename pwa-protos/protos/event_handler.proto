syntax = "proto3";

package eventhandler.v1;

service EventHandlerService {
    rpc ViewContent          (ViewContentRequest)          returns (FirstOpenResponse);
    rpc PrepareInstallLink   (PrepareInstallLinkRequest)   returns (PrepareInstallLinkResponse);
    rpc PwaFirstOpen         (PwaFirstOpenRequest)         returns (GenericOk);
    rpc Lead                 (LeadRequest)                 returns (GenericOk);
    rpc CompleteRegistration (CompleteRegistrationRequest) returns (GenericOk);
    rpc Purchase             (PurchaseRequest)             returns (GenericOk);
    rpc Subscribe            (SubscribeRequest)            returns (GenericOk);
}

message ViewContentRequest {
    string userId         = 1;
    string pwaDomain      = 2;
    string landingUrl     = 3;
    string queryStringRaw = 4;
    string sessionId      = 5;
}

message PrepareInstallLinkRequest {
    string userId    = 1;
    string pwaDomain = 2;
    string sessionId = 3;
}

message PwaFirstOpenRequest {
    string userId    = 1;
    string pwaDomain = 2;
    string sessionId = 3;
}

message LeadRequest {
    string userId         = 1;
    string pwaDomain      = 2;
    string landingUrl     = 3;
    string queryStringRaw = 4;
    string sessionId      = 5;
}

message CompleteRegistrationRequest {
    string userId         = 1;
    string pwaDomain      = 2;
    string landingUrl     = 3;
    string queryStringRaw = 4;
    string sessionId      = 5;
}

message PurchaseRequest {
    string userId         = 1;
    string pwaDomain      = 2;
    string landingUrl     = 3;
    string queryStringRaw = 4;
    double value          = 5;
    string currency       = 6;
    string sessionId      = 7;
}

message SubscribeRequest {
    string userId         = 1;
    string pwaDomain      = 2;
    string landingUrl     = 3;
    string queryStringRaw = 4;
    double value          = 5;
    string currency       = 6;
    string sessionId      = 7;
}

message FirstOpenResponse {
    bool success     = 1;
    string fb        = 2;
    string sessionId = 3;
}

message GenericOk {
    bool success = 1;
    string fb    = 2;
}

message PrepareInstallLinkResponse {
    string finalUrl = 1;
}
